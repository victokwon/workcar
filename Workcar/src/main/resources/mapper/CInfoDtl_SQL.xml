<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="CInfoDtl_SQL">
	<select id="getP1" parameterType="hashmap"
		resultType="hashmap">
		select name, pos , email,c_boss,c_name , ci.addr , ci.addr_dtl, regexp_replace(phone,'(.{3})(.+)(.{4})','\1-\2-\3') phone, regexp_replace( sales_amount, '(.{3})(.{3})(.{3})','\1,\2,\3,\4') SALES_AMOUNT, REG_DATE, regexp_replace (wrk_cnt ,'(.{3})','\1,\2' ) wrk_cnt, sector_no,c_hpage,list_chk
        from member m join c_member cm on m.mem_no = cm.mem_no
        join c_info ci on cm.corp_no = ci.corp_no
        join c_sales cs on ci.corp_no = cs.corp_no
        join c_sector cc on ci.corp_no = cc.corp_no
        left join i_member im on im.mem_no = m.mem_no
        where m.mem_gbn = 2
        and m.mem_no = 3
	</select>
	<select id="getP2Cnt" parameterType="hashmap"
		resultType="Integer">
		select count(c.corp_no) cnt 
        from c_info c join c_sales cs on c.corp_no = cs.corp_no 
	</select>
	<select id="getP2" parameterType="hashmap"
		resultType="hashmap">
		select c_name, rtrim (trunc( sales_amount, -8),'0') sales, to_char(reg_date,'yy-mm-dd') reg_date
        from c_info c join c_sales cs on c.corp_no = cs.corp_no  
	</select>
	
</mapper>