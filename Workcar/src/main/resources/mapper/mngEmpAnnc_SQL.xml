<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mngempanc">

<select id="empAncList" parameterType="hashMap" resultType="hashMap">
<!-- SELECT OPNCHK, EMP_NO, MEM_NO, EMP_TITLE, SECTOR_NO, REGION_NAME, CITY_NAME, RECRUIT_GBN,PAY_GBN, PAY_LOW, PAY_HIGH, EMP_GBN, 
TO_CHAR(DLINE, 'YYYY-MM-DD') AS DLINE, TO_CHAR(REG_DATE,'YYYY-MM-DD') AS REG_DATE, DTL, VIEWS, DEL_CHK, CARR_Y, 
EMP_PER, EMP_DOC, EMP_PRCS
FROM EMP_ANNC E JOIN REGION R ON (E.REGION_NO = R.REGION_NO)
                JOIN CITY C ON (E.CITY_NO = C.CITY_NO)
                JOIN (SELECT CAT_NAME AS OPNCHK, SCD_CAT FROM COMM_CODE WHERE FST_CAT = 4)CODE
                ON ( CODE.SCD_CAT = E.RECRUIT_GBN)
	WHERE MEM_NO  =#{memberNo}
 -->
 
SELECT  C_NAME, OPNCHK, EMP_NO, E.MEM_NO, EMP_TITLE, SECTOR_NO, REGION_NAME, CITY_NAME, RECRUIT_GBN,PAY_GBN, PAY_LOW, PAY_HIGH, EMP_GBN, 
TO_CHAR(DLINE, 'YYYY-MM-DD') AS DLINE, TO_CHAR(REG_DATE,'YYYY-MM-DD') AS REG_DATE, DTL, DEL_CHK, CARR_Y, 
EMP_PER, EMP_DOC, EMP_PRCS, DEL_CHK, E.VIEWS
FROM EMP_ANNC E JOIN REGION R ON (E.REGION_NO = R.REGION_NO)
                JOIN CITY C ON (E.CITY_NO = C.CITY_NO)
                JOIN (SELECT CAT_NAME AS OPNCHK, SCD_CAT FROM COMM_CODE WHERE FST_CAT = 4)CODE
                ON ( CODE.SCD_CAT = E.RECRUIT_GBN)
                JOIN (SELECT CORP_NO, MEM_NO FROM C_MEMBER) CORP
                ON ( CORP.MEM_NO = E.MEM_NO)
                JOIN C_INFO CI ON CORP.CORP_NO = CI.CORP_NO
WHERE E.MEM_NO = #{memberNo}
AND DEL_CHK = 0
ORDER BY EMP_NO DESC 

<!-- SELECT  C_NAME, OPNCHK, E.EMP_NO, E.MEM_NO, E.EMP_TITLE, SECTOR_NO, REGION_NAME, CITY_NAME, RECRUIT_GBN,PAY_GBN, PAY_LOW, PAY_HIGH, EMP_GBN, 
TO_CHAR(E.DLINE, 'YYYY-MM-DD') AS DLINE, TO_CHAR(E.REG_DATE,'YYYY-MM-DD') AS REG_DATE, DTL, E.DEL_CHK, CARR_Y, 
EMP_PER, EMP_DOC, EMP_PRCS, E.VIEWS, RESUM_NO, FINDCHK
FROM EMP_ANNC E JOIN REGION R ON (E.REGION_NO = R.REGION_NO)
                JOIN CITY C ON (E.CITY_NO = C.CITY_NO)
                JOIN (SELECT CAT_NAME AS OPNCHK, SCD_CAT FROM COMM_CODE WHERE FST_CAT = 4)CODE
                ON ( CODE.SCD_CAT = E.RECRUIT_GBN)
                JOIN (SELECT CORP_NO, MEM_NO FROM C_MEMBER) CORP
                ON ( CORP.MEM_NO = E.MEM_NO)
                JOIN C_INFO CI ON CORP.CORP_NO = CI.CORP_NO
                JOIN RESUM_SUPP RS ON E.EMP_NO = RS.EMP_NO
                JOIN (SELECT CAT_NAME AS FINDCHK, SCD_CAT FROM COMM_CODE WHERE FST_CAT = 9)CODE2
                ON(CODE2.SCD_CAT = FIND_CHK)
WHERE E.MEM_NO = #{memberNo}
AND E.DEL_CHK = 0
ORDER BY E.EMP_NO DESC -->
</select>

<select id ="empResumeList" parameterType="hashmap" resultType="hashmap">
 SELECT  E.EMP_NO, E.MEM_NO, RESUM_NO, FINDCHK,PRCSCHK, TO_CHAR(RS.REG_DATE, 'YYYY-MM-DD') AS REG_DATE
FROM EMP_ANNC E JOIN (SELECT CAT_NAME AS OPNCHK, SCD_CAT FROM COMM_CODE WHERE FST_CAT = 4)CODE
                ON ( CODE.SCD_CAT = E.RECRUIT_GBN)
                JOIN (SELECT CORP_NO, MEM_NO FROM C_MEMBER) CORP
                ON ( CORP.MEM_NO = E.MEM_NO)
                JOIN RESUM_SUPP RS ON E.EMP_NO = RS.EMP_NO
                JOIN (SELECT CAT_NAME AS FINDCHK, SCD_CAT FROM COMM_CODE WHERE FST_CAT = 9)CODE2
                ON(CODE2.SCD_CAT = FIND_CHK)
                JOIN (SELECT CAT_NAME AS PRCSCHK, SCD_CAT FROM COMM_CODE WHERE FST_CAT = 10)CODE3
                ON(CODE3.SCD_CAT = PRCSS_STATE)
WHERE E.MEM_NO = #{MEM_NO}
AND E.EMP_NO = #{EMP_NO}
AND E.DEL_CHK = 0
AND RS.DEL_CHK =0
ORDER BY RESUM_NO DESC;


</select>



<update id="delEmpAnc" parameterType="hashmap">
	UPDATE EMP_ANNC SET DEL_CHK = 1
	WHERE EMP_NO = #{EMP_NO}
	AND MEM_NO = #{MEM_NO}

</update>

</mapper>