<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="CinfoSearch">

	<select id="getCInfoSch1Cnt" parameterType="hashmap" resultType="Integer">
		SELECT COUNT(*)AS CNT
		FROM C_INFO CI
		JOIN C_SECTOR CS
		ON (CI.CORP_NO = CS.CORP_NO)
		JOIN SECTOR S
		ON (CS.SECTOR_NO = S.SECTOR_NO)
		WHERE CI.WRK_CNT &gt;= 1
		<choose>
			<when test="searchGbn eq 0">
				AND CI.C_NAME LIKE '%' || #{searchTxt} || '%'
				OR S.SECTOR_NAME LIKE '%' || #{searchTxt} || '%'
				
			</when>
			<when test="searchGbn eq 1">
				AND CI.C_NAME LIKE '%' || #{searchTxt} || '%'
			</when>
			<when test="searchGbn eq 2">
				AND S.SECTOR_NAME LIKE '%' || #{searchTxt} || '%'
			</when>
		</choose>
		
	</select>
	<select id="getCInfoSch1List" parameterType="hashmap" resultType="hashmap">
		SELECT C.CORP_NO,C.CORP_IMG,C.C_NAME, C.ADDR,C.C_BOSS, C.SECTOR_NAME
		FROM (
        SELECT CI.CORP_NO,CI.CORP_IMG,CI.C_NAME, CI.ADDR,CI.C_BOSS,S.SECTOR_NAME,
        ROW_NUMBER()OVER(ORDER BY CI.CORP_NO DESC) AS ENUM
        FROM C_INFO CI
		JOIN C_SECTOR CS
		ON CI.CORP_NO = CS.CORP_NO
		JOIN SECTOR S
		ON CS.SECTOR_NO = S.SECTOR_NO
		WHERE CI.WRK_CNT &gt;= 1
		<choose>
			<when test="searchGbn eq 0">
				AND CI.C_NAME LIKE '%' || #{searchTxt} || '%'
				OR S.SECTOR_NAME LIKE '%' || #{searchTxt} || '%'
				
			</when>
			<when test="searchGbn eq 1">
				AND CI.C_NAME LIKE '%' || #{searchTxt} || '%'
			</when>
			<when test="searchGbn eq 2">
				AND S.SECTOR_NAME LIKE '%' || #{searchTxt} || '%'
			</when>
		</choose>
        )C
		WHERE C.ENUM BETWEEN #{startCnt} AND #{endCnt}
	</select>
</mapper>